<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Blockly ‚Üí Java (Buttons-Only Class Mode)</title>

  <!-- Blockly Core -->
  <script src="../../blockly_compressed.js"></script>
  <script src="../../blocks_compressed.js"></script>

  <!-- Java generator for this fork (repo root) -->
  <script src="../../java_compressed.js"></script>

  <!-- Messages -->
  <script src="../../msg/js/en.js"></script>

  <style>
    html, body {
      height: 100%;
      margin: 0;
      overflow: hidden;
      overscroll-behavior: none;
      touch-action: none;
      font-family: Arial, sans-serif;
    }
    body { display: flex; flex-direction: column; }

    #header {
      padding: 10px;
      background: #f5f5f5;
      border-bottom: 1px solid #ccc;
      display: flex;
      align-items: center;
      gap: 12px;
    }
    #header h2 {
      margin: 0;
      font-size: 18px;
      white-space: nowrap;
    }
    #header .spacer { flex: 1 1 auto; }

    button, label { font-size: 13px; }
    button { padding: 6px 10px; cursor: pointer; }

    .toggle {
      display: inline-flex;
      gap: 6px;
      align-items: center;
      padding: 4px 6px;
      background: #fff;
      border: 1px solid #ccc;
      border-radius: 4px;
      white-space: nowrap;
    }

    #layout {
      flex: 1;
      min-height: 0;
      display: flex;
    }

    #sidebar {
      width: 280px;
      border-right: 1px solid #ccc;
      background: #fafafa;
      padding: 10px;
      box-sizing: border-box;
      overflow: auto;
    }

    .group {
      margin-bottom: 12px;
      border: 1px solid #ddd;
      background: #fff;
      border-radius: 6px;
      padding: 10px;
    }
    .group h3 {
      margin: 0 0 8px 0;
      font-size: 14px;
    }

    .btnGrid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 8px;
    }
    .btnGrid button {
      width: 100%;
      text-align: left;
    }

    #main {
      flex: 1;
      min-width: 0;
      display: flex;
      flex-direction: column;
      min-height: 0;
    }

    #blocklyDiv {
      flex: 1;
      min-height: 0;
      border-bottom: 1px solid #ccc;
      touch-action: none;
    }
    .blocklySvg { touch-action: none; }

    #status {
      border: 0;
      border-top: 1px solid #ddd;
      padding: 8px 10px;
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
      font-size: 12px;
      background: #fff;
      white-space: pre-wrap;
      height: 80px;
      overflow: auto;
    }

    #codeArea {
      height: 260px;
      width: 100%;
      border: 0;
      border-top: 1px solid #ddd;
      padding: 10px;
      box-sizing: border-box;
      resize: none;
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
      font-size: 13px;
      outline: none;
      white-space: pre;
    }

    .tip {
      margin-top: 10px;
      font-size: 12px;
      color: #555;
      line-height: 1.35;
    }
  </style>
</head>

<body>

  <div id="header">
    <h2>Blockly ‚Üí Java (Buttons-Only Class Mode)</h2>

    <span class="toggle" title="Unchecked: show student code only. Checked: show full generator output (includes runtime).">
      <input type="checkbox" id="toggleFull">
      <label for="toggleFull">Show full code</label>
    </span>

    <div class="spacer"></div>

    <button id="btnGen">Generate Java</button>
    <button id="btnDownload">Download Main.java</button>
    <button id="btnClear">Clear</button>
  </div>

  <div id="layout">
    <!-- LEFT: categorized add buttons -->
    <div id="sidebar">

      <div class="group">
        <h3>Logic</h3>
        <div class="btnGrid">
          <button id="btnIf">+ If</button>
          <button id="btnIfElse">+ If / Else</button>
          <button id="btnCompare">+ Compare</button>
          <button id="btnAndOr">+ And/Or</button>
          <button id="btnNot">+ Not</button>
          <button id="btnBool">+ true/false</button>
        </div>
      </div>

      <div class="group">
        <h3>Loops</h3>
        <div class="btnGrid">
          <button id="btnRepeat">+ Repeat</button>
          <button id="btnWhile">+ While</button>
          <button id="btnFor">+ For</button>
          <button id="btnForEach">+ For Each</button>
        </div>
      </div>

      <div class="group">
        <h3>Lists</h3>
        <div class="btnGrid">
          <button id="btnListCreate">+ Create List</button>
          <button id="btnListGet">+ Get Item</button>
          <button id="btnListSet">+ Set Item</button>
          <button id="btnListLen">+ Length</button>
        </div>
        <div class="tip">
          Tip: Use <b>Create List</b> to make a list value, then plug it into the <b>For Each</b> block‚Äôs ‚Äúin‚Äù slot
          (or set it to a variable first).
        </div>
      </div>

      <div class="group">
        <h3>Math</h3>
        <div class="btnGrid">
          <button id="btnNumber">+ Number</button>
          <button id="btnAdd">+ A + B</button>
          <button id="btnSub">+ A - B</button>
          <button id="btnMul">+ A x B</button>
        </div>
      </div>

      <div class="group">
        <h3>Text</h3>
        <div class="btnGrid">
          <button id="btnPrint">+ Print</button>
          <button id="btnText">+ "text"</button>
          <button id="btnJoin">+ Join</button>
          <button id="btnLength">+ Length</button>
        </div>
      </div>

      <div class="group">
        <h3>Variables</h3>
        <div class="btnGrid">
          <button id="btnVarSet">+ Set Var</button>
          <button id="btnVarGet">+ Get Var</button>
          <button id="btnVarInc">+ Change Var</button>
          <button id="btnVarCreate">+ New Var</button>
        </div>

        <div class="tip">
          Tip: The sidebar is for adding blocks reliably. Students can still drag blocks
          <b>inside the workspace</b> to snap them together.
        </div>
      </div>

    </div>

    <!-- RIGHT: workspace + output -->
    <div id="main">
      <div id="blocklyDiv"></div>
      <div id="status">Status will appear here‚Ä¶</div>
      <textarea id="codeArea" tabindex="-1" placeholder="Generated Java code will appear here..."></textarea>
    </div>
  </div>

  <script>
    function log(msg) {
      var el = document.getElementById('status');
      el.textContent = (el.textContent ? el.textContent + "\n" : "") + msg;
      el.scrollTop = el.scrollHeight;
    }

    window.addEventListener('error', function (e) {
      log("JS ERROR: " + (e.message || e) + (e.filename ? (" @ " + e.filename + ":" + e.lineno) : ""));
    });

    // Workspace WITHOUT toolbox (no flyout)
    var workspace = Blockly.inject('blocklyDiv', {
      trashcan: true,
      scrollbars: true,
      zoom: {
        controls: true,
        wheel: false,
        startScale: 1.0,
        maxScale: 3,
        minScale: 0.3,
        scaleSpeed: 1.2
      }
    });

    // Prevent wheel/trackpad scrolling from causing weird behavior
    document.getElementById('blocklyDiv').addEventListener('wheel', function(e) {
      e.preventDefault();
    }, { passive: false });

    setTimeout(function () {
      if (typeof Blockly.svgResize === 'function') Blockly.svgResize(workspace);
      log("‚úÖ Workspace ready.");
      log("Blockly version: " + (Blockly.VERSION || "unknown"));
      log("Java generator present: " + (Blockly.Java ? "YES" : "NO"));
      log("Default output: STUDENT-FRIENDLY code only (toggle shows full runtime).");
    }, 0);

    window.addEventListener('resize', function () {
      if (typeof Blockly.svgResize === 'function') Blockly.svgResize(workspace);
    });

    // Auto-placement for click-to-add
    var nextX = 40, nextY = 40;
    function placeBlock(block) {
      block.initSvg();
      block.render();
      block.moveBy(nextX, nextY);
      nextY += 70;
      if (nextY > 420) { nextY = 40; nextX += 300; }
      block.select();
    }

    // Compatible block creation for old/new Blockly
    function createBlock(type) {
      var block;
      if (workspace.newBlock) {
        block = workspace.newBlock(type);
      } else if (Blockly.Block && Blockly.Block.obtain) {
        block = Blockly.Block.obtain(workspace, type);
      } else {
        throw new Error("No supported block creation API found.");
      }
      placeBlock(block);
      return block;
    }

    function safeAdd(type, fields) {
      try {
        if (!Blockly.Blocks || !Blockly.Blocks[type]) {
          log("‚ùå Block type not found: " + type);
          return null;
        }
        var b = createBlock(type);
        if (fields) {
          for (var k in fields) {
            try { b.setFieldValue(fields[k], k); } catch (e) {}
          }
        }
        log("‚ûï Added: " + type);
        return b;
      } catch (e) {
        log("‚ùå Add failed (" + type + "): " + e);
        return null;
      }
    }

    // Add IF/ELSE: controls_if with else branch enabled
    function addIfElse() {
      var b = safeAdd('controls_if');
      if (!b) return;

      try {
        b.elseifCount_ = b.elseifCount_ || 0;
        b.elseCount_ = 1;
        if (typeof b.updateShape_ === 'function') b.updateShape_();
        if (typeof b.initSvg === 'function') b.initSvg();
        if (typeof b.render === 'function') b.render();
        log("‚ûï Updated controls_if to include ELSE.");
      } catch (e) {
        log("‚ÑπÔ∏è Could not auto-add ELSE on this build. Use the mutator (gear) if available.");
      }
    }

    // Variables differ across versions
    function safeAddVarSet() {
      var candidates = ['variables_set', 'variables_set_dynamic'];
      for (var i = 0; i < candidates.length; i++) {
        if (Blockly.Blocks && Blockly.Blocks[candidates[i]]) return safeAdd(candidates[i]);
      }
      log("‚ùå No variable SET block found.");
      return null;
    }

    function safeAddVarGet() {
      var candidates = ['variables_get', 'variables_get_dynamic'];
      for (var i = 0; i < candidates.length; i++) {
        if (Blockly.Blocks && Blockly.Blocks[candidates[i]]) return safeAdd(candidates[i]);
      }
      log("‚ùå No variable GET block found.");
      return null;
    }

    function safeAddVarChange() {
      var candidates = ['math_change', 'variables_set'];
      for (var i = 0; i < candidates.length; i++) {
        if (Blockly.Blocks && Blockly.Blocks[candidates[i]]) return safeAdd(candidates[i]);
      }
      log("‚ùå No variable change block found (math_change).");
      return null;
    }

    function clearWorkspace() {
      workspace.clear();
      nextX = 40; nextY = 40;
      document.getElementById('codeArea').value = '';
      log("üßπ Cleared workspace.");
    }

    // ‚úÖ CRASH FIX: Blockly.Java.init() calls Variables.allVariablesTypes which crashes in your build
    // (getOutput().slice on null). We don't need types for beginner output, so fail-safe to [].
    function installVariablesTypeDiscoveryFix() {
      if (!window.Blockly || !Blockly.Variables) return;
      if (Blockly.Variables.__patchedAllVariablesTypes) return;

      var orig = Blockly.Variables.allVariablesTypes;
      Blockly.Variables.allVariablesTypes = function(ws) {
        try {
          return orig ? orig.call(this, ws) : [];
        } catch (e) {
          return [];
        }
      };

      Blockly.Variables.__patchedAllVariablesTypes = true;
    }

    // --- Runtime split (hide huge chunk) ---
    function splitStudentAndRuntime(fullCode) {
      if (!fullCode) return { student: "", runtime: "" };

      // Common runtime markers found in this fork output.
      var markers = [
        "\nfinal class Var ",
        "\nclass Var ",
        "\nenum Var ",
        "\nfinal class Runtime ",
        "\nclass Runtime ",
        "\nfinal class Blockly",
        "\nclass Blockly"
      ];

      var cut = -1;
      for (var i = 0; i < markers.length; i++) {
        var idx = fullCode.indexOf(markers[i]);
        if (idx !== -1 && (cut === -1 || idx < cut)) cut = idx;
      }

      if (cut === -1) {
        return { student: fullCode.trim(), runtime: "" };
      }

      return {
        student: fullCode.substring(0, cut).trim(),
        runtime: fullCode.substring(cut).trim()
      };
    }

    // --- Student-ifier: remove package/imports + class wrapper + comments + simplify Var.valueOf(...) patterns ---
    function studentify(code) {
      if (!code) return "";

      var s = code;

      // Remove package line
      s = s.replace(/^\s*package\s+[\w.]+\s*;\s*$/gmi, "");

      // Remove ALL imports
      s = s.replace(/^\s*import\s+[\w.*]+\s*;\s*$/gmi, "");

      // Remove /* ... */ block comments (including /** ... */)
      s = s.replace(/\/\*[\s\S]*?\*\//g, "");

      // Remove common "end while" style line comments
      s = s.replace(/^\s*\/\/\s*end\s+.*$/gmi, "");

      // Remove wrapper class (e.g., public class MyApp { ... } or class MyApp { ... })
      // Prefer public-class match first; fall back to non-public class.
      var classMatch = s.match(/public\s+class\s+\w+\s*\{([\s\S]*)\}\s*$/m);
      if (!classMatch || !classMatch[1]) {
        classMatch = s.match(/(?:^|\n)\s*class\s+\w+\s*\{([\s\S]*)\}\s*$/m);
      }
      if (classMatch && classMatch[1]) {
        s = classMatch[1];
      }

      // Remove method wrapper like: public static void main(...) { ... } (if generator made one)
      var mainMatch = s.match(/public\s+static\s+void\s+main\s*\(\s*String\[\]\s*\w+\s*\)\s*\{([\s\S]*)\}\s*$/m);
      if (mainMatch && mainMatch[1]) {
        s = mainMatch[1];
      }

      // Convert: !Var.valueOf(x).equals(10)  ->  (x != 10)
      s = s.replace(/!\s*Var\.valueOf\(\s*([A-Za-z_]\w*)\s*\)\.equals\(\s*([^)]+?)\s*\)/g,
                    "($1 != $2)");

      // Convert: Var.valueOf(x).equals(10) -> (x == 10)
      s = s.replace(/Var\.valueOf\(\s*([A-Za-z_]\w*)\s*\)\.equals\(\s*([^)]+?)\s*\)/g,
                    "($1 == $2)");

      // Remove .toString() on string literals: "hi".toString() -> "hi"
      s = s.replace(/"([^"\\]*(\\.[^"\\]*)*)"\.toString\(\)/g, "\"$1\"");

      // Remove access modifiers at start of lines (so declarations can live in main if needed)
      s = s.replace(/^\s*(public|private|protected)\s+/gmi, "");

      // Remove any stray lone braces lines
      s = s.replace(/^\s*\{\s*$/gmi, "");
      s = s.replace(/^\s*\}\s*$/gmi, "");

      // Clean up extra blank lines
      s = s.replace(/^\s*\n/gm, "");
      s = s.trim();

      return s;
    }

    // --- NEW: Simplify list initializations + numbers into beginner-friendly arrays ---
    function simplifyListsAndNumbers(studentCode) {
      if (!studentCode) return "";

      var s = studentCode;

      // Convert:
      //   LinkedList X;
      //   X = new LinkedList<>(Arrays.asList(10.0, 100.0));
      // -> int[] X = {10, 100};
      var re = /(?:LinkedList|ArrayList)\s+([A-Za-z_]\w*)\s*;\s*\1\s*=\s*new\s+(?:LinkedList|ArrayList)<>\s*\(\s*Arrays\.asList\(([\s\S]*?)\)\s*\)\s*;\s*/g;

      s = s.replace(re, function(_, varName, valuesRaw) {
        var parts = valuesRaw.split(",").map(function(p){ return p.trim(); }).filter(Boolean);

        var isString = parts.some(function(v) { return /^".*"$/.test(v); });
        var isDouble = parts.some(function(v) { return /\d+\.\d+/.test(v) && !/\.0+$/.test(v); });

        var cleaned = parts.map(function(v) { return v.replace(/(\d+)\.0+\b/g, "$1"); });

        var type = "int";
        if (isString) type = "String";
        else if (isDouble) type = "double";

        return type + "[] " + varName + " = {" + cleaned.join(", ") + "};\n";
      });

      // ‚úÖ IMPORTANT: Convert Var-style setObject(List) into array declaration:
      //   item.setObject(new LinkedList<>(Arrays.asList(10, 100)));
      // -> int[] item = {10, 100};
      var reSetObj = /([A-Za-z_]\w*)\.setObject\(\s*new\s+(?:LinkedList|ArrayList)<>\s*\(\s*Arrays\.asList\(([\s\S]*?)\)\s*\)\s*\)\s*;\s*/g;

      s = s.replace(reSetObj, function(_, varName, valuesRaw) {
        var parts = valuesRaw.split(",").map(function(p){ return p.trim(); }).filter(Boolean);

        var isString = parts.some(function(v) { return /^".*"$/.test(v); });
        var isDouble = parts.some(function(v) { return /\d+\.\d+/.test(v) && !/\.0+$/.test(v); });

        var cleaned = parts.map(function(v) { return v.replace(/(\d+)\.0+\b/g, "$1"); });

        var type = "int";
        if (isString) type = "String";
        else if (isDouble) type = "double";

        return type + "[] " + varName + " = {" + cleaned.join(", ") + "};\n";
      });

      // General cleanup: 10.0 -> 10
      s = s.replace(/(\d+)\.0+\b/g, "$1");

      // Replace .size() -> .length
      s = s.replace(/([A-Za-z_]\w*)\.size\(\)/g, "$1.length");

      // Replace .get(i) -> [i]
      s = s.replace(/([A-Za-z_]\w*)\.get\(\s*([^)]+?)\s*\)/g, function(_, list, index) {
        return list + "[" + index + "]";
      });

      // Remove (int)(...) style casts often used in indexes
      s = s.replace(/\(int\)\s*\(([^)]+)\)/g, "$1");
      s = s.replace(/\[\s*\(int\)\s*([^\]]+?)\s*\]/g, "[$1]");

      // Remove .toString()
      s = s.replace(/\.toString\(\)/g, "");

      // Remove Var wrappers (student output)
      // Var item = new Var(0);  -> remove entirely
      s = s.replace(/Var\s+[A-Za-z_]\w*\s*=\s*new\s+Var\([^)]*\);\s*/g, "");

      // item.setObject(X); -> item = X; (kept as a fallback if not a list)
      s = s.replace(/([A-Za-z_]\w*)\.setObject\(([^)]+)\);/g, "$1 = $2;");

      // item.cloneObject() -> item
      s = s.replace(/([A-Za-z_]\w*)\.cloneObject\(\)/g, "$1");

      // Force foreach header: Object i : ... -> int i : ...
      s = s.replace(/for\s*\(\s*Object\s+([A-Za-z_]\w*)\s*:/g, "for (int $1 :");

      return s.trim();
    }

    function indentLines(text, spaces) {
      var pad = "";
      for (var i = 0; i < spaces; i++) pad += " ";
      return text.split("\n").map(function(line) {
        return line.trim().length ? (pad + line.trim()) : "";
      }).join("\n");
    }

    // Wrap student code into beginner-friendly Main.main()
    function wrapInMain(studentOnly) {
      var body = (studentOnly || "").trim();
      var mainBody = body ? indentLines(body, 4) : "";

      return (
        "public class Main {\n" +
        "  public static void main(String[] args) {\n" +
        (mainBody ? (mainBody + "\n") : "") +
        "  }\n" +
        "}\n"
      );
    }

    // üî• For-each override: simple intro Java foreach (while loops unchanged)
    function installForEachNUKEFix() {
      if (!window.Blockly || !Blockly.Generator || !Blockly.Java) return;

      function fixedForEach(block) {
        var varName = "item";
        try {
          var raw = block.getFieldValue('VAR');
          if (raw && Blockly.Java.variableDB_ && Blockly.Variables) {
            varName = Blockly.Java.variableDB_.getName(raw, Blockly.Variables.NAME_TYPE);
          } else if (raw) {
            varName = raw;
          }
        } catch (e) {}

        var listCode = "list1";
        try {
          listCode = Blockly.Java.valueToCode(block, 'LIST', Blockly.Java.ORDER_NONE) || "list1";
        } catch (e) {
          listCode = "list1";
        }

        var body = "";
        try {
          body = Blockly.Java.statementToCode(block, 'DO') || "";
        } catch (e) {
          body = "";
        }

        // ‚úÖ use int for beginner foreach
        return 'for (int ' + varName + ' : ' + listCode + ') {\n' + body + '}\n';
      }

      Blockly.Java['controls_forEach'] = fixedForEach;
      if (Blockly.Java.forBlock) Blockly.Java.forBlock['controls_forEach'] = fixedForEach;

      if (!Blockly.Generator.prototype.__patchedForEachNuke) {
        var orig = Blockly.Generator.prototype.blockToCode;
        Blockly.Generator.prototype.blockToCode = function(block, opt_this) {
          if (this && this.name_ === 'Java' && block && block.type === 'controls_forEach') {
            return fixedForEach(block);
          }
          return orig.call(this, block, opt_this);
        };
        Blockly.Generator.prototype.__patchedForEachNuke = true;
      }
    }

    // Keep your existing loop behavior (you asked while loops unchanged)
    function generateJava() {
      try {
        if (!Blockly.Java) {
          log("‚ùå Blockly.Java is NOT defined. java_compressed.js may not be loading.");
          return;
        }

        // install patches
        installVariablesTypeDiscoveryFix();
        installForEachNUKEFix();

        var full = Blockly.Java.workspaceToCode(workspace) || "";
        var showFull = document.getElementById('toggleFull').checked;

        if (showFull) {
          document.getElementById('codeArea').value = full;
          log("‚úÖ Generated FULL output (includes runtime). chars=" + full.length);
          return;
        }

        var parts = splitStudentAndRuntime(full);
        var student = simplifyListsAndNumbers(studentify(parts.student));
        var wrapped = wrapInMain(student);

        document.getElementById('codeArea').value = wrapped;
        log("‚úÖ Generated STUDENT-FRIENDLY code (runtime hidden).");
      } catch (e) {
        log("‚ùå Generate Java failed: " + e);
        if (e && e.stack) log("STACK:\n" + e.stack);
      }
    }

    function downloadJava() {
      if (!document.getElementById('codeArea').value.trim()) generateJava();

      var contents = document.getElementById('codeArea').value || "";
      if (!contents.trim()) {
        log("‚ùå Nothing to download yet. Add blocks and generate first.");
        return;
      }

      var blob = new Blob([contents], { type: "text/plain;charset=utf-8" });
      var url = URL.createObjectURL(blob);

      var a = document.createElement('a');
      a.href = url;
      a.download = "Main.java";
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);

      URL.revokeObjectURL(url);
      log("‚¨áÔ∏è Downloaded Main.java (" + contents.length + " chars).");
    }

    // ---- Sidebar wiring ----
    document.getElementById('btnIf').addEventListener('click', function () { safeAdd('controls_if'); });
    document.getElementById('btnIfElse').addEventListener('click', addIfElse);
    document.getElementById('btnCompare').addEventListener('click', function () { safeAdd('logic_compare'); });
    document.getElementById('btnAndOr').addEventListener('click', function () { safeAdd('logic_operation'); });
    document.getElementById('btnNot').addEventListener('click', function () { safeAdd('logic_negate'); });
    document.getElementById('btnBool').addEventListener('click', function () { safeAdd('logic_boolean'); });

    document.getElementById('btnRepeat').addEventListener('click', function () { safeAdd('controls_repeat_ext'); });
    document.getElementById('btnWhile').addEventListener('click', function () { safeAdd('controls_whileUntil'); });
    document.getElementById('btnFor').addEventListener('click', function () { safeAdd('controls_for'); });
    document.getElementById('btnForEach').addEventListener('click', function () { safeAdd('controls_forEach'); });

    // Lists
    document.getElementById('btnListCreate').addEventListener('click', function () { safeAdd('lists_create_with'); });
    document.getElementById('btnListGet').addEventListener('click', function () { safeAdd('lists_getIndex'); });
    document.getElementById('btnListSet').addEventListener('click', function () { safeAdd('lists_setIndex'); });
    document.getElementById('btnListLen').addEventListener('click', function () { safeAdd('lists_length'); });

    document.getElementById('btnNumber').addEventListener('click', function () { safeAdd('math_number', {NUM: '10'}); });
    document.getElementById('btnAdd').addEventListener('click', function () { safeAdd('math_arithmetic', {OP: 'ADD'}); });
    document.getElementById('btnSub').addEventListener('click', function () { safeAdd('math_arithmetic', {OP: 'MINUS'}); });
    document.getElementById('btnMul').addEventListener('click', function () { safeAdd('math_arithmetic', {OP: 'MULTIPLY'}); });

    document.getElementById('btnPrint').addEventListener('click', function () { safeAdd('text_print'); });
    document.getElementById('btnText').addEventListener('click', function () { safeAdd('text'); });
    document.getElementById('btnJoin').addEventListener('click', function () { safeAdd('text_join'); });
    document.getElementById('btnLength').addEventListener('click', function () { safeAdd('text_length'); });

    document.getElementById('btnVarSet').addEventListener('click', safeAddVarSet);
    document.getElementById('btnVarGet').addEventListener('click', safeAddVarGet);
    document.getElementById('btnVarInc').addEventListener('click', safeAddVarChange);
    document.getElementById('btnVarCreate').addEventListener('click', function () {
      log("‚ÑπÔ∏è Use 'Set Var' then rename the variable dropdown to create new names.");
    });

    document.getElementById('btnGen').addEventListener('click', generateJava);
    document.getElementById('btnDownload').addEventListener('click', downloadJava);
    document.getElementById('btnClear').addEventListener('click', clearWorkspace);
  </script>

</body>
</html>
